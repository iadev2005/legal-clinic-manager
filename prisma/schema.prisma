generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =====================================================
// ENUMS PRINCIPALES
// =====================================================
enum TipoSexo {
  M
  F
}

enum TipoNacionalidad {
  VEN
  EXT
}

enum TipoEstadoCivil {
  Soltero
  Casado
  Divorciado
  Viudo
}

enum TipoCondicionTrabajo {
  Patrono
  Empleado
  Obrero
  Cuenta_propia
}

enum TipoCondicionActividad {
  Ama_de_Casa
  Estudiante
  Pensionado_Jubilado
  Otra
}

enum TipoVivienda {
  Casa
  Apartamento
  Otro
}

enum TipoBeneficiarioRel {
  Directo
  Indirecto
}

enum TipoTramite {
  Asesoria
  Conciliacion_y_Mediacion
  Redaccion_documentos_y_o_convenio
  Asistencia_Judicial_Casos_externos
}

enum EstatusCaso {
  En_proceso
  Archivado
  Entregado
  Asesoria
}

// =====================================================
// MODELOS QUE VAMOS A MANIPULAR EN LA UI
// =====================================================
model Solicitante {
  cedula_solicitante   String   @id @db.VarChar(20)
  nombres              String?  @db.VarChar(100)
  apellidos            String?  @db.VarChar(100)
  tlf_local            String?  @db.VarChar(20)
  tlf_celular          String?  @db.VarChar(20)
  correo               String?  @db.VarChar(100)
  sexo                 TipoSexo?
  fecha_nacimiento     DateTime?
  nacionalidad         TipoNacionalidad?
  edo_civil            TipoEstadoCivil?
  tipo_vivienda        TipoVivienda?
  parroquia_residencia String?  @db.VarChar(100)
  comunidad_residencia String?  @db.VarChar(100)
  trabaja              Boolean?
  condicion_trabajo    TipoCondicionTrabajo?
  condicion_actividad  TipoCondicionActividad?
  educacion_alcanzada  String?  @db.VarChar(100)
  casos                Caso[]
}

model Expediente_Tribunal {
  nro_expediente_tribunal String @id @db.VarChar(50)
  casos                   Caso[]
  documentos              Documento[]
}

model Caso {
  nro_caso               Int                  @id @default(autoincrement())
  tipo_caso              String?              @db.VarChar(100)
  tramite                TipoTramite?
  estatus                EstatusCaso?
  observacion            String?
  periodo                String?              @db.VarChar(50)
  fecha_caso             DateTime?
  nro_expediente_tribunal String?             @db.VarChar(50)
  cedula_solicitante     String?              @db.VarChar(20)

  solicitante Solicitante?         @relation(fields: [cedula_solicitante], references: [cedula_solicitante])
  expediente  Expediente_Tribunal? @relation(fields: [nro_expediente_tribunal], references: [nro_expediente_tribunal])

  beneficiarios Beneficiario_Caso[]
  acciones      Accion[]
  documentos    Documento[]
}

model Beneficiario {
  id_beneficiario Int       @id @default(autoincrement())
  cedula          String?   @db.VarChar(20)
  nombres         String?   @db.VarChar(100)
  apellidos       String?   @db.VarChar(100)
  sexo            TipoSexo?
  fecha_nacimiento DateTime?
  edad            Int?

  casos Beneficiario_Caso[]
}

model Beneficiario_Caso {
  id               Int                 @id @default(autoincrement())
  id_beneficiario  Int
  nro_caso         Int
  tipo_beneficiario TipoBeneficiarioRel?
  tipo_parentesco  String? @db.VarChar(50)

  beneficiario Beneficiario @relation(fields: [id_beneficiario], references: [id_beneficiario])
  caso         Caso         @relation(fields: [nro_caso], references: [nro_caso])
}

model Usuario {
  cedula_usuario   String   @id @db.VarChar(20)
  nombres          String?  @db.VarChar(100)
  apellidos        String?  @db.VarChar(100)
  telefono_local   String?  @db.VarChar(20)
  telefono_celular String?  @db.VarChar(20)
  correo           String?  @db.VarChar(100)
  sexo             TipoSexo?
  tipo_usuario     String?  @db.VarChar(50)

  acciones Accion[]
}

model Accion {
  id                    Int      @id @default(autoincrement())
  nro_caso              Int?
  titulo_accion         String?  @db.VarChar(150)
  observacion           String?
  cedula_usuario        String?  @db.VarChar(20)
  fecha_accion          DateTime?
  fecha_registro_accion DateTime? @default(now())

  caso   Caso?    @relation(fields: [nro_caso], references: [nro_caso])
  usuario Usuario? @relation(fields: [cedula_usuario], references: [cedula_usuario])
}

model Documento {
  id_documento  Int      @id @default(autoincrement())
  nro_expediente String?
  inicio_folio  Int?
  final_folio   Int?
  fecha         DateTime?
  tipo          String?  @db.VarChar(50)
  nro_caso      Int?

  expediente Expediente_Tribunal? @relation(fields: [nro_expediente], references: [nro_expediente_tribunal])
  caso       Caso?               @relation(fields: [nro_caso], references: [nro_caso])
}